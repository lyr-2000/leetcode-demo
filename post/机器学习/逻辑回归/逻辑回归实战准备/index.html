<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>逻辑回归实战准备 - 凌冬的代码博客站</title><meta name=renderer content="webkit"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=cache-control content="no-transform"><meta http-equiv=cache-control content="no-siteapp"><meta name=theme-color content="#f8f5ec"><meta name=msapplication-navbutton-color content="#f8f5ec"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="#f8f5ec"><meta name=author content="lyr"><meta name=description content="逻辑回归实战 分类散点图可视化 逻辑回归模型使用 建立新书籍 模型评估 分类散点图可视化 1 2 3 4 5 6 7 8 9 # 未区分类别散点图 plt.scatter(x1,x2) #区分类别散点图 mask = y==1 type1"><meta name=keywords content="凌冬的博客,LYR的个人博客,二次元技术宅"><meta name=generator content="Hugo 0.114.0 with theme even"><link rel=canonical href=https://lyr-2000.github.io/code/post/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92%E5%AE%9E%E6%88%98%E5%87%86%E5%A4%87/><link rel=apple-touch-icon sizes=180x180 href=/code/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/code/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/code/favicon-16x16.png><link rel=manifest href=/code/manifest.json><link rel=mask-icon href=/code/safari-pinned-tab.svg color=#5bbad5><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script>
<link href=/code/sass/main.min.4d31fe93a248bf2a033aec98b3dca0e0e3f55453ad76230e57f190d60450d008.css rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin=anonymous><link rel=stylesheet href=/css/../code/static/css/post.css><meta property="og:title" content="逻辑回归实战准备"><meta property="og:description" content="逻辑回归实战 分类散点图可视化 逻辑回归模型使用 建立新书籍 模型评估 分类散点图可视化 1 2 3 4 5 6 7 8 9 # 未区分类别散点图 plt.scatter(x1,x2) #区分类别散点图 mask = y==1 type1"><meta property="og:type" content="article"><meta property="og:url" content="https://lyr-2000.github.io/code/post/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92%E5%AE%9E%E6%88%98%E5%87%86%E5%A4%87/"><meta property="og:image" content="https://tva2.sinaimg.cn/large/9bd9b167gy1g4lifg75yjj21hc0xckjl.jpg"><meta property="article:section" content="post"><meta property="article:published_time" content="2022-10-30T16:37:11+08:00"><meta property="article:modified_time" content="2022-05-11T20:02:48+08:00"><meta itemprop=name content="逻辑回归实战准备"><meta itemprop=description content="逻辑回归实战 分类散点图可视化 逻辑回归模型使用 建立新书籍 模型评估 分类散点图可视化 1 2 3 4 5 6 7 8 9 # 未区分类别散点图 plt.scatter(x1,x2) #区分类别散点图 mask = y==1 type1"><meta itemprop=datePublished content="2022-10-30T16:37:11+08:00"><meta itemprop=dateModified content="2022-05-11T20:02:48+08:00"><meta itemprop=wordCount content="707"><meta itemprop=image content="https://tva2.sinaimg.cn/large/9bd9b167gy1g4lifg75yjj21hc0xckjl.jpg"><meta itemprop=keywords content="逻辑回归,"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://tva2.sinaimg.cn/large/9bd9b167gy1g4lifg75yjj21hc0xckjl.jpg"><meta name=twitter:title content="逻辑回归实战准备"><meta name=twitter:description content="逻辑回归实战 分类散点图可视化 逻辑回归模型使用 建立新书籍 模型评估 分类散点图可视化 1 2 3 4 5 6 7 8 9 # 未区分类别散点图 plt.scatter(x1,x2) #区分类别散点图 mask = y==1 type1"><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css></head><body><div><button class="button pink back">back</button>
<button class="button pink go">go</button>
<button class="button pink topUrl">top</button></div><div id=globalbg></div><div id=mobile-navbar class=mobile-navbar><div class=mobile-header-logo><a href=/ class=logo>凌冬的博客</a></div><div class=mobile-navbar-icon><span></span>
<span></span>
<span></span></div></div><nav id=mobile-menu class="mobile-menu slideout-menu"><ul class=mobile-menu-list><li style=display:inline-block;margin-right:10px><input type=search class=mob-docsearch-input placeholder=Search></li><a href=/code/><li class=mobile-menu-item>首页</li></a><a href=/code/post/><li class=mobile-menu-item>归档页</li></a><a href=/code/tags/><li class=mobile-menu-item>标签</li></a><a href=/code/categories/><li class=mobile-menu-item>分类</li></a><a href=/code/about/><li class=mobile-menu-item>关于</li></a><a href=/code/friends><li class=mobile-menu-item>友链</li></a><a href=/code/search/><li class=mobile-menu-item>搜索</li></a></ul></nav><div class=container id=mobile-panel><header id=header class=header><div class=logo-wrapper><a href=/ class=logo>凌冬的博客</a></div><nav class=site-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=/code/>首页</a></li><li class=menu-item><a class=menu-item-link href=/code/post/>归档页</a></li><li class=menu-item><a class=menu-item-link href=/code/tags/>标签</a></li><li class=menu-item><a class=menu-item-link href=/code/categories/>分类</a></li><li class=menu-item><a class=menu-item-link href=/code/about/>关于</a></li><li class=menu-item><a class=menu-item-link href=/code/friends>友链</a></li><li class=menu-item><a class=menu-item-link href=/code/search/>搜索</a></li><li style=list-style:none;position:relative;left:360px;bottom:32px><input type=search class="docsearch-input PC_MARK1" placeholder=Search></li></ul></nav><style>.mob-docsearch-input{border:1px solid #ccc;padding:6px 0;border-radius:3px;padding-left:5px;position:relative;vertical-align:top;width:93%;margin:auto;margin-left:7px}input.PC_MARK1{border:1px solid #ccc;padding:6px 0;border-radius:3px;padding-left:5px;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,.075);box-shadow:inset 0 1px 1px rgba(0,0,0,.075);-webkit-transition:border-color ease-in-out .15s,-webkit-box-shadow ease-in-out .15s;-o-transition:border-color ease-in-out .15s,box-shadow ease-in-out .15s;transition:border-color ease-in-out .15s,box-shadow ease-in-out .15s}input.PC_MARK1:focus{border-color:#66afe9;outline:0;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 8px rgba(102,175,233,.6);box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 8px rgba(102,175,233,.6)}</style></header><div class=customByLyr><img class=lazyload draggable=false data-original=https://tva2.sinaimg.cn/large/9bd9b167gy1g4lifg75yjj21hc0xckjl.jpg></div><main id=main class=main><div class=content-wrapper><div id=content class=content><article class=post><header class=post-header><h1 class=post-title>逻辑回归实战准备</h1><div class=post-meta><span class=post-time>2022-10-30</span><div class=post-category><a href=/code/categories/%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/>逻辑回归</a></div><span class=more-meta>约 707 字</span>
<span class=more-meta>预计阅读 2 分钟</span>
<span id=busuanzi_container_page_pv class=more-meta><span id=busuanzi_value_page_pv><img src=/code/img/spinner.svg alt=spinner.svg></span> 次阅读</span></div></header><div class=post-toc id=post-toc><h2 class=post-toc-title>文章目录</h2><div class=post-toc-content><nav id=TableOfContents><ul><li><ul><li><a href=#逻辑回归实战>逻辑回归实战</a><ul><li><a href=#分类散点图可视化>分类散点图可视化</a></li><li><a href=#逻辑回归实现二分类算法>逻辑回归实现二分类算法</a></li><li><a href=#计算准确率>计算准确率</a></li></ul></li><li><a href=#预测考试通过率>预测考试通过率</a><ul><li><a href=#加载数据集>加载数据集</a></li><li><a href=#绘制散点图>绘制散点图</a></li><li><a href=#模型精准度评估>模型精准度评估</a></li><li><a href=#绘制拟合曲线>绘制拟合曲线</a></li></ul></li></ul></li></ul></nav></div></div><div class=post-content><h2 id=逻辑回归实战>逻辑回归实战</h2><ul><li>分类散点图可视化</li><li>逻辑回归模型使用</li><li>建立新书籍</li><li>模型评估</li></ul><h3 id=分类散点图可视化>分类散点图可视化</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 未区分类别散点图</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>x1</span><span class=p>,</span><span class=n>x2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#区分类别散点图</span>
</span></span><span class=line><span class=cl><span class=n>mask</span> <span class=o>=</span> <span class=n>y</span><span class=o>==</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>type1</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>x1</span><span class=p>[</span><span class=n>mask</span><span class=p>],</span><span class=n>x2</span><span class=p>[</span><span class=n>mask</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>type2</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>x1</span><span class=p>[</span><span class=o>~</span><span class=n>mask</span><span class=p>],</span><span class=n>x2</span><span class=p>[</span><span class=o>~</span><span class=n>mask</span><span class=p>],</span><span class=n>maker</span><span class=o>=</span><span class=s1>&#39;^&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=逻辑回归实现二分类算法>逻辑回归实现二分类算法</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 训练模型</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sklearn.linear_model</span> <span class=kn>import</span> <span class=n>logisticRegression</span>
</span></span><span class=line><span class=cl><span class=n>lr_model</span> <span class=o>=</span> <span class=n>logisticRegression</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>lr_model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># 边界函数</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>theta1</span><span class=p>,</span><span class=n>theta2</span> <span class=o>=</span> <span class=n>LR</span><span class=o>.</span><span class=n>conef_</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>],</span><span class=n>LR</span><span class=o>.</span><span class=n>coef</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>thea0</span> <span class=o>=</span> <span class=n>LR</span><span class=o>.</span><span class=n>intercept_</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=c1># 数据预测</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>predictions</span> <span class=o>=</span> <span class=n>lr_model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>x_new</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=计算准确率>计算准确率</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sklearn.mertrics</span> <span class=kn>import</span> <span class=n>accuracy_score</span>
</span></span><span class=line><span class=cl><span class=n>y_predict</span> <span class=o>=</span> <span class=n>LR</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>accuracy</span> <span class=o>=</span> <span class=n>accuracy_score</span><span class=p>(</span><span class=n>y</span><span class=p>,</span><span class=n>y_predict</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 画图来查看边界效果，可视化模型表现</span>
</span></span><span class=line><span class=cl><span class=c1># 绘制预测的模型图像</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>x1</span><span class=p>,</span><span class=n>x2_boundary</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># 绘制周围实际数据的散点图</span>
</span></span><span class=line><span class=cl><span class=n>passed</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>x1</span><span class=p>[</span><span class=n>mask</span><span class=p>],</span><span class=n>x2</span><span class=p>[</span><span class=n>mask</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>failed</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>x1</span><span class=p>[</span><span class=o>~</span><span class=n>mask</span><span class=p>],</span><span class=n>x2</span><span class=p>[</span><span class=o>~</span><span class=n>mask</span><span class=p>],</span><span class=n>maker</span><span class=o>=</span><span class=s1>&#39;^&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=预测考试通过率>预测考试通过率</h2><p>数据如下：</p><p>Exam1, Exam2, Pass<br>34 78 0<br>30 43 0<br>60 86 1</p><p>若干数据</p><h3 id=加载数据集>加载数据集</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s1>&#39;examdata.csv&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>data</span><span class=o>.</span><span class=n>head</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=绘制散点图>绘制散点图</h3><p>绘制 exam2 为y轴，exam1 为 x轴的图</p><p><img class=md__image_http src=https://s2.loli.net/2022/11/03/eCvwGRpNtJcZ5WI.png alt="图 1"></p><p>定义 mask 为 pass ,如果是 1 就是通过，对mask 取反 就是不通过<br>分别绘制 mask, 和 <code>~mask</code> 的曲线，得到散点图</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=o>%</span><span class=n>matplotlib</span> <span class=n>inline</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>matplotlib</span> <span class=kn>import</span> <span class=n>pyplot</span> <span class=k>as</span> <span class=n>plt</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span><span class=mi>4</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=c1># plt.figure()</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>plt.scatter(data.loc[:,&#39;Exam1&#39;],data.loc[:,&#39;Exam2&#39;])
</span></span></span><span class=line><span class=cl><span class=s2>plt.title(&#39;exam1 and exam2&#39;)
</span></span></span><span class=line><span class=cl><span class=s2>plt.xlabel(&#39;Exam1&#39;)
</span></span></span><span class=line><span class=cl><span class=s2>plt.ylabel(&#39;Exam2&#39;)
</span></span></span><span class=line><span class=cl><span class=s2>plt.show()
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># mask --&gt; 通过的， ~mask 表示不通过的</span>
</span></span><span class=line><span class=cl><span class=n>mask</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>loc</span><span class=p>[:,</span><span class=s1>&#39;Pass&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=c1># print(mask)</span>
</span></span><span class=line><span class=cl><span class=n>fig2</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span><span class=mi>4</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>passed</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>loc</span><span class=p>[:,</span><span class=s1>&#39;Exam1&#39;</span><span class=p>][</span><span class=n>mask</span><span class=p>],</span><span class=n>data</span><span class=o>.</span><span class=n>loc</span><span class=p>[:,</span><span class=s1>&#39;Exam2&#39;</span><span class=p>][</span><span class=n>mask</span><span class=p>],</span><span class=n>color</span><span class=o>=</span><span class=s1>&#39;green&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>failed</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>loc</span><span class=p>[:,</span><span class=s1>&#39;Exam1&#39;</span><span class=p>][</span><span class=o>~</span><span class=n>mask</span><span class=p>],</span><span class=n>data</span><span class=o>.</span><span class=n>loc</span><span class=p>[:,</span><span class=s1>&#39;Exam2&#39;</span><span class=p>][</span><span class=o>~</span><span class=n>mask</span><span class=p>],</span><span class=n>color</span><span class=o>=</span><span class=s1>&#39;red&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>&#39;Exam1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>&#39;Exam2&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>((</span><span class=n>passed</span><span class=p>,</span><span class=n>failed</span><span class=p>),(</span><span class=s1>&#39;passed&#39;</span><span class=p>,</span><span class=s1>&#39;failed&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=模型精准度评估>模型精准度评估</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 绘制曲线模拟</span>
</span></span><span class=line><span class=cl><span class=c1># 删除最后一列</span>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>drop</span><span class=p>([</span><span class=s1>&#39;Pass&#39;</span><span class=p>],</span><span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># print(X)</span>
</span></span><span class=line><span class=cl><span class=c1># 获取最后一列 </span>
</span></span><span class=line><span class=cl><span class=n>y</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>loc</span><span class=p>[:,</span><span class=s1>&#39;Pass&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=c1># print(y)</span>
</span></span><span class=line><span class=cl><span class=n>x1</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>loc</span><span class=p>[:,</span><span class=s1>&#39;Exam1&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>x2</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>loc</span><span class=p>[:,</span><span class=s1>&#39;Exam2&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=c1># x.head()</span>
</span></span><span class=line><span class=cl><span class=c1># 开始训练模式-- 逻辑回归模型</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sklearn.linear_model</span> <span class=kn>import</span> <span class=n>LogisticRegression</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>model</span> <span class=o>=</span> <span class=n>LogisticRegression</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>x</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span><span class=n>y</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 训练模型结束</span>
</span></span><span class=line><span class=cl><span class=n>predict_yvalue</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># print(predict_yvalue)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 准确率</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sklearn.metrics</span> <span class=kn>import</span> <span class=n>accuracy_score</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>score</span> <span class=o>=</span> <span class=n>accuracy_score</span><span class=p>(</span><span class=n>y</span><span class=p>,</span><span class=n>predict_yvalue</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;模型得分：&#34;</span><span class=p>,</span><span class=n>score</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># 预测两个考试成绩为 70,65分的是否能通过</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;passed&#39;</span> <span class=k>if</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>([[</span><span class=mi>70</span><span class=p>,</span><span class=mi>65</span><span class=p>]])</span> <span class=o>==</span> <span class=mi>1</span> <span class=k>else</span> <span class=s1>&#39;failed&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=绘制拟合曲线>绘制拟合曲线</h3><p>定义拟合曲线 <code>ax+by+c = 0</code>, 求出 曲线系数</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 系数</span>
</span></span><span class=line><span class=cl><span class=n>model</span><span class=o>.</span><span class=n>coef_</span>
</span></span><span class=line><span class=cl><span class=c1># 截距</span>
</span></span><span class=line><span class=cl><span class=n>model</span><span class=o>.</span><span class=n>intercept_</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>a</span><span class=p>,</span><span class=n>b</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>coef_</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>],</span><span class=n>model</span><span class=o>.</span><span class=n>coef_</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>c</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>intercept_</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>,</span><span class=n>c</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>y2</span>  <span class=o>=</span> <span class=o>-</span><span class=p>(</span><span class=n>c</span> <span class=o>+</span> <span class=n>a</span><span class=o>*</span> <span class=n>x1</span><span class=p>)</span><span class=o>/</span><span class=n>b</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>y2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>x1</span><span class=p>,</span><span class=n>y2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># plt.show()</span>
</span></span><span class=line><span class=cl><span class=c1># ax+by+c = 0 , 线性方程</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ---draw</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># mask --&gt; 通过的， ~mask 表示不通过的</span>
</span></span><span class=line><span class=cl><span class=n>mask</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>loc</span><span class=p>[:,</span><span class=s1>&#39;Pass&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=c1># print(mask)</span>
</span></span><span class=line><span class=cl><span class=c1># fig2 = plt.figure(figsize=(4,4))</span>
</span></span><span class=line><span class=cl><span class=n>passed</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>loc</span><span class=p>[:,</span><span class=s1>&#39;Exam1&#39;</span><span class=p>][</span><span class=n>mask</span><span class=p>],</span><span class=n>data</span><span class=o>.</span><span class=n>loc</span><span class=p>[:,</span><span class=s1>&#39;Exam2&#39;</span><span class=p>][</span><span class=n>mask</span><span class=p>],</span><span class=n>color</span><span class=o>=</span><span class=s1>&#39;green&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>failed</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>loc</span><span class=p>[:,</span><span class=s1>&#39;Exam1&#39;</span><span class=p>][</span><span class=o>~</span><span class=n>mask</span><span class=p>],</span><span class=n>data</span><span class=o>.</span><span class=n>loc</span><span class=p>[:,</span><span class=s1>&#39;Exam2&#39;</span><span class=p>][</span><span class=o>~</span><span class=n>mask</span><span class=p>],</span><span class=n>color</span><span class=o>=</span><span class=s1>&#39;red&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>&#39;Exam1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>&#39;Exam2&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>((</span><span class=n>passed</span><span class=p>,</span><span class=n>failed</span><span class=p>),(</span><span class=s1>&#39;passed&#39;</span><span class=p>,</span><span class=s1>&#39;failed&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>结果如图所示：</p><p><img class=md__image_http src=https://s2.loli.net/2022/11/03/m4LN7YJbserFwnt.png alt="图 2"></p></div><div class=post-copyright><p class=copyright-item><span class=item-title>文章作者</span>
<span class=item-content>lyr</span></p><p class=copyright-item><span class=item-title>上次更新</span>
<span class=item-content>2022-05-11</span></p></div><footer class=post-footer><div class=post-tags><a href=/code/tags/%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/>逻辑回归</a></div><nav class=post-nav><a class=prev href=/code/post/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/python%E8%AF%AD%E6%B3%95/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/numpy%E8%AF%A6%E7%BB%86%E7%94%A8%E6%B3%95/><i class="iconfont icon-left"></i>
<span class="prev-text nav-default">numpy详细用法</span>
<span class="prev-text nav-mobile">上一篇</span></a>
<a class=next href=/code/post/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B/><span class="next-text nav-default">逻辑回归模型</span>
<span class="next-text nav-mobile">下一篇</span>
<i class="iconfont icon-right"></i></a></nav></footer></article></div><div id=gitalk-container></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js crossorigin=anonymous></script>
<script type=text/javascript>var gitalk=new Gitalk({id:"2022-10-30 16:37:11 \u002b0800 \u002b0800",title:"逻辑回归实战准备",clientID:"604ae0a4eff099135503",clientSecret:"403ff7c3a3ff6a91d905110c91eb1651219b7233",repo:"lyr-2000.github.io",owner:"lyr-2000",admin:["lyr-2000"],body:decodeURI(location.href)});gitalk.render("gitalk-container")</script><noscript>Please enable JavaScript to view the <a href=https://github.com/gitalk/gitalk>comments powered by gitalk.</a></noscript></div></main><footer id=footer class=footer><div class=social-links><a href=mailto:lyr-2000@qq.com class="iconfont icon-email" title=email></a>
<a href=https://lyr-2000.github.io/code/index.xml type=application/rss+xml class="iconfont icon-rss" title=rss></a></div><div class=copyright><span class=power-by>由 <a class=hexo-link href=https://gohugo.io>Hugo</a> 强力驱动</span>
<span class=division>|</span>
<span class=theme-info>主题 -
<a class=theme-link href=https://github.com/olOwOlo/hugo-theme-even>Even</a></span><div class=busuanzi-footer><span id=busuanzi_container_site_pv>本站总访问量 <span id=busuanzi_value_site_pv><img src=/code/img/spinner.svg alt=spinner.svg></span> 次</span>
<span class=division>|</span>
<span id=busuanzi_container_site_uv>本站总访客数 <span id=busuanzi_value_site_uv><img src=/code/img/spinner.svg alt=spinner.svg></span> 人</span></div><span class=copyright-year>&copy;
2021-09-23 -
2024<span class=heart><i class="iconfont icon-heart"></i></span><span>LYR</span></span></div><script src=https://cdn.jsdelivr.net/gh/lyr-2000/live2d-widget@latest/autoload.js></script></footer><div class=back-to-top id=back-to-top><i class="iconfont icon-up"></i></div></div><div id=BR_cornner><div id=darkThemeBtn>T</div></div><script src=https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js></script>
<script defer async>mermaid.initialize({startOnLoad:!0})</script></body></html>